# HDU-3567

## Eight II

` 地址https://vjudge.net/article/187`

### Descriptions：

```
Eight-puzzle, which is also called "Nine grids", comes from an old game.

In this game, you are given a 3 by 3 board and 8 tiles. The tiles are numbered from 1 to 8 and each covers a grid. As you see, there is a blank grid which can be represented as an 'X'. Tiles in grids having a common edge with the blank grid can be moved into that blank grid. This operation leads to an exchange of 'X' with one tile.

We use the symbol 'r' to represent exchanging 'X' with the tile on its right side, and 'l' for the left side, 'u' for the one above it, 'd' for the one below it.
```
![pku src img](https://acm.hdu.edu.cn/data/images/C301-1004-1.jpg)
`A state of the board can be represented by a string S using the rule showed below.`
![pku src img](https://acm.hdu.edu.cn/data/images/C301-1004-2.jpg)
```
The problem is to operate an operation list of 'r', 'u', 'l', 'd' to turn the state of the board from state A to state B. You are required to find the result which meets the following constrains:
1. It is of minimum length among all possible solutions.
2. It is the lexicographically smallest one of all solutions of minimum length.
```


### Input

```
The first line is T (T <= 200), which means the number of test cases of this problem.

The input of each test case consists of two lines with state A occupying the first line and state B on the second line.
It is guaranteed that there is an available solution from state A to B.
```

### OutPut

```
For each test case two lines are expected.

The first line is in the format of "Case x: d", in which x is the case number counted from one, d is the minimum length of operation list you need to turn A to B.
S is the operation list meeting the constraints and it should be showed on the second line.
```


### Sample Input

```
2
12X453786
12345678X
564178X23
7568X4123
```

### Sample Output

```
Case 1: 2
dd
Case 2: 8
urrulldr
```

### 思路

```
游戏中有一个 3×3 的棋盘和 8 个编号为 1 到 8 的棋子，每个棋子占据一个格子。棋盘上有一个空白格子，用字符 'X' 表示。与空白格子有公共边的棋子，可以移动到空白格子中 —— 该操作本质是 'X' 与对应棋子的交换。
本题要求：给定操作序列（由 'r'、'u'、'l'、'd' 组成），将棋盘从状态 A 转换为状态 B。需找到满足以下约束的结果：
操作序列长度为所有可行解中的最小值（最短路径）；
在所有最短路径中，操作序列的字典序最小。

1.操作顺序：dirs 数组按字典序从小到大排列（d、l、r、u），确保 BFS 时优先尝试字典序小的操作，这样第一个找到的最短路径就是字典序最小的。
2.状态转换：通过交换X与目标位置的字符生成新状态，避免了复杂的坐标计算（利用索引差：左右移动 ±1，上下移动 ±3，因每行 3 个元素）。
3.合法性检查：根据X的位置（索引）判断操作是否合法（如第一列不能左移，第一行不能上移等）。


普通的八数码问题（判断是否有解）与本题（求最短且字典序最小的路径）在核心目标和解决方法上有本质区别，题目已明确 “保证存在可行解”，因此无需判断可解性。核心目标是找到最短路径，且在最短路径中选择字典序最小的操作序列。此时逆序数不再直接参与，重点是通过 BFS 等算法搜索路径。
```

### Code

见 chapter2  HDU3567函数